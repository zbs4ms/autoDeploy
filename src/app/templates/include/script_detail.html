<div id="detail" style="display: none" ng-controller="detailCtrl">
    <div class="row-fluid title">
        <a style="float: right" href="javascript:void(0)" ng-click="back()" class="btn btn-info">
            <span aria-hidden="true"></span>返回
        </a>

        <h3>编辑脚本</h3>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <button style="float: right" class="btn btn-default" data-toggle="modal" ng-click="test_click()" data-target="#console">测试脚本</button>
                    <a href="javascript:void(0)" ng-click="tab_click('bash')" ng-class="{'selected_target':detail.script.type=='bash'}">Bash
                        Shell</a>
                    <span style="margin-left: 30px "></span>
                    <a href="javascript:void(0)" ng-click="tab_click('expect')" ng-class="{'selected_target':detail.script.type=='expect'}">Expect
                        Shell</a>

                </div>
                <div class="panel-body">
                    <textarea id="bash_shell"
                              ng-model="detail.script.bash_shell" placeholder="请输入 BASH SHELL 脚本"
                              class="form-control script_edit_window" style="height: 50%"
                              ng-class="{'hide':detail.script.type!='bash'}"></textarea>
                    <textarea id="expect_shell"
                              ng-mode="detail.script.expect_shell" placeholder="请输入 EXPECT SHELL 脚本"
                              class="form-control script_edit_window" style="height: 50%"
                              ng-class="{'hide':detail.script.type!='expect'}"></textarea>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">执行结果检查</h3>
                </div>
                <div class="panel-body">
                    开发中。。。
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <button class="btn btn-large btn-block btn-info" ng-click="save_script()" type="button">保存</button>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="console" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="min-width: 900px;">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="panel panel-default">
                        <div class="panel-body console_window" style="min-height:400px;overflow-y: auto">

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>



<script>
    App.controller("detailCtrl", function ($scope,$http) {
        $scope.tab_click=function(type){
            $scope.detail.script.type=type;
        }

        $scope.test_click=function(){
            $(".console_window").html("执行中请等待....")
            var param=$scope.detail.script
            $http.post('/post/test/script',param).success(function (data) {
                var content="";
                for(i in data){
                    content+=data[i]+"<br/>"
                }
                $(".console_window").html(content)
            }).error(function () {
                console.log("数据加载出错");
            });
        }

        $('#console').on('hidden.bs.modal', function (e) {
            //alert(1)
        })

    });
</script>